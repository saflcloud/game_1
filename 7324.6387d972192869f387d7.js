"use strict";(self.webpackChunkmy_vue_app=self.webpackChunkmy_vue_app||[]).push([[7324],{64652:function(e,t,r){r.d(t,{Z:function(){return x},A:function(){return a}});var n,a,i=r(23279),s=r.n(i),c=r(74492),o=r(21797),l=r(92317),u=r(82345),d=r(72283),p=r(20793),v=r(50125),h=(r(92222),r(26699),r(32023),r(41539),r(39714),r(21249),r(74916),r(23123),r(9653),r(70189),r(78783),r(33948),r(69600),r(30813)),f=r(95306),y=r(90825),k=r(86493),b=r(81764),m=r(98292),Z="iLDn4PsfD0WoS02JLAe_",g="L44VFWoA15URSoZa4Em0";!function(e){e[e.EVENT=0]="EVENT",e[e.TASK=1]="TASK",e[e.AWARD=2]="AWARD"}(a||(a={}));var x=(0,h.wA)({name:"MyReceiveBase"})(n=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;(0,o.Z)(this,r);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e=t.call.apply(t,[this].concat(i)),(0,v.Z)((0,u.Z)(e),"type",a.EVENT),(0,v.Z)((0,u.Z)(e),"checkedNever",!1),(0,v.Z)((0,u.Z)(e),"receiveAllTypes",[]),e}return(0,l.Z)(r,[{key:"platfromid",get:function(){return(0,m.h)().userInfos.platfromid}},{key:"getVisibleTypes",value:function(){var e=(0,k.cF)("receiveAllTypes")[this.platfromid]||"";e.includes(this.type.toString())&&(this.checkedNever=!0),this.receiveAllTypes=e?e.split(",").map((function(e){return Number(e)})):[]}},{key:"setVisibleType",value:function(e){var t=new Set(this.receiveAllTypes);this.checkedNever=!this.checkedNever,t.has(e)?t.delete(e):t.add(e),this.receiveAllTypes=(0,c.Z)(t),(0,k.po)((0,v.Z)({},this.platfromid,this.receiveAllTypes.join(",")),"receiveAllTypes")}},{key:"openReceiveModal",value:function(e){var t=this,r=e.type,n=e.content,a=e.onOk,i=e.onCancel,c=this.$createElement;this.type=r,this.getVisibleTypes();var o=s()(a,500);if(this.receiveAllTypes.includes(r))o();else{var l=(0,m.h)().isWeb,u=(0,b.QT)().t;y.sG.Modal.create({class:Z,title:u("lobby.receiveModal.kindTips"),width:l?550:600,content:function(){return c("div",[c("p",[n]),c("div",{class:g,on:{click:function(){t.setVisibleType(r)}}},[c(f.XZ.Tsx,{attrs:{checked:t.checkedNever}}),c("span",[" ",u("lobby.receiveModal.gotIt")])])])},okText:u("lobby.receiveModal.ok").toString(),onOk:o,onCancel:i})}}}]),r}(h.XY))||n},58220:function(e,t,r){r.r(t),r.d(t,{default:function(){return Le}});var n,a,i,s,c,o,l,u,d,p,v,h,f,y,k,b,m,Z,g,x,T,C,w=r(74492),S=r(55673),A=r(70970),R=r(2813),P=r(21797),I=r(92317),M=r(82345),W=r(72283),_=r(20793),z=r(50125),N=r(17360),D=(r(92222),r(41539),r(78783),r(33948),r(34553),r(21249),r(39714),r(69826),r(57327),r(9653),r(74916),r(23123),r(38880),r(14577)),E=r(95306),H=r(90416),L=r(30813),Y=r(90825),O=r(88521),G=r(3438),V=r(81764),B=r(98292),K=r(23504),F=r(71707),Q=r(76937),j=r(58334),$=r(39175),q=r(59700),J=r(64652),X=r(3587),U=(r(41320),r(98256)),ee=r(57111),te="IW_zFDb6MiTLdPkXtmEN",re="igkwz5zhclIs1HxhinLc",ne="PkvFG1r6ikmJU7aNeMqs",ae="LSwOjSisZch45p1ILeaX",ie="QY_U_zIYjp_18JDkB_dO",se="CcgW_iwO3imaCEFBHG_0",ce="eLabjcpw_vhPD57L8zy3",oe="SVH69YxggQ0ozPJaLEso",le="AjMqHRvfkiCzySzN2ATl",ue="Xmvuu2C1TX6WfCwG_DRC",de="WYuhLp0mMdrmckTp0vbY",pe="ryd8ArFT5jw6cF256cMw",ve="eAqnKkBJdyMZZ_6wT8uM",he="G7ZtaN0qW4fvXtxVMiI_",fe="PNbVPwtQLk9YyMREOI2e",ye="uP76WGv0dFPS1S_u760Q",ke="UeW4cD4k3XW9d0f5noui",be="UbFRok_6jERq2fY5jYJO",me="NwagJW3WjbkdoTbvYiQ8",Ze="QDbVwv8Jri2t31emhSTw",ge=r(41800),xe=(n=(0,L.wA)({name:"TaskTabList"}),a=(0,L.fI)({required:!0}),i=(0,D.K4)(),n((c=function(e){(0,W.Z)(a,e);var t,r,n=(0,_.Z)(a);function a(){var e;(0,P.Z)(this,a);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e=n.call.apply(n,[this].concat(r)),(0,z.Z)((0,M.Z)(e),"renderKey",0),(0,X.Z)((0,M.Z)(e),"fetchData",o,(0,M.Z)(e)),e}return(0,I.Z)(a,[{key:"activityStore",get:function(){return(0,G.j)()}},{key:"taskCategoriesStore",get:function(){return(0,K.$)()}},{key:"isWeb",get:function(){return(0,B.h)().isWeb}},{key:"mainStore",get:function(){return(0,B.h)()}},{key:"goRecords",value:function(){U.Z.Modal.close("taskModal"),this.$router.push({name:Q.x4.RECORDS})}},{key:"handleCollectAllPrizes",value:(r=(0,R.Z)((0,A.Z)().mark((function e(){var t,r,n,a,i,s,c=this;return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,V.QT)(),r=t.t,n=this.taskCategoriesStore.categories,a=this.activityStore,i=a.setIsFetching,s=a.box,this.openReceiveModal({type:J.A.TASK,content:r("lobby.receiveModal.eventContent"),onOk:function(){var e=(0,R.Z)((0,A.Z)().mark((function e(){var t,a,o,l,u,d,p;return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i(!0),t=null==s?void 0:s.filter((function(e){return e.status===O.H3.CanReceive})),null==t||!t.length){e.next=21;break}a=(0,S.Z)(t),e.prev=5,a.s();case 7:if((o=a.n()).done){e.next=13;break}return l=o.value,e.next=11,(0,ge.Z)((0,j.cB)(l.id));case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),a.e(e.t0);case 18:return e.prev=18,a.f(),e.finish(18);case 21:return u=n.reduce((function(e,t){var r;return null!==(r=t.receiveRuleIds)&&void 0!==r&&r.length?e.concat(t.receiveRuleIds.map((function(e){return{taskid:t.taskId,template:t.template,ruleid:e}}))):e}),[]),d=[],p=[],u.map((function(e){var t=e.taskid+"_"+e.template;-1===d.indexOf(t)&&d.push(t)})),d.map((function(e){p.push({taskid:Number(e.split("_")[0]),template:Number(e.split("_")[1]),disabled:!1})})),e.next=28,Promise.all(p.map(function(){var e=(0,R.Z)((0,A.Z)().mark((function e(t){return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.uA)({taskid:t.taskid,template:t.template}).then((function(e){(0,$.cA)(e.receiveDeviceType)||(t.disabled=!0)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 28:if(p.map((function(e){e.disabled&&u.map((function(t){t.taskid===e.taskid&&t.template===e.template&&(t.disabled=!0)}))})),u=u.filter((function(e){return!0!==e.disabled})),!u.length){e.next=35;break}return e.next=33,Promise.all(u.map(function(){var e=(0,R.Z)((0,A.Z)().mark((function e(t){return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ge.Z)((0,j.Kp)({taskid:t.taskid,template:t.template,ruleid:t.ruleid}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 33:e.sent.every((function(e){return!e[0]}))&&(U.Z.Modal.message({type:"success",content:r("lobby.modal.task.receiveSussessTip")}),c.mainStore.audioReceivePlay(),c.mainStore.updateReceiveAward());case 35:return e.next=37,c.fetchData(!!u.length);case 37:c.renderKey+=1,c.mainStore.updatePrize(),e.next=44;break;case 41:e.prev=41,e.t1=e.catch(0),console.error(e.t1);case 44:case"end":return e.stop()}}),e,null,[[0,41],[5,15,18,21]])})));return function(){return e.apply(this,arguments)}}()});case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"onTabsChange",value:(t=(0,R.Z)((0,A.Z)().mark((function e(t){return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.taskCategoriesStore.setTab(t);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"renderTask",value:function(e){var t=this.$createElement,r=this.taskCategoriesStore.categories.find((function(t){return t.taskId===e}));return r?t(ee.Z,{attrs:{tab:this.taskCategoriesStore.tab,category:r},key:r.category+this.renderKey}):t("template")}},{key:"render",value:function(){var e,t,r,n,a=this,i=arguments[0],s=(0,V.QT)(),c=s.t,o=this.activityStore.status===O.Tx.Close,l=this.taskCategoriesStore.categories,u=l.some((function(e){var t;return null===(t=e.receiveRuleIds)||void 0===t?void 0:t.length}))||(null===(e=this.activityStore.box)||void 0===e?void 0:e.some((function(e){return e.status===O.H3.CanReceive}))),d=[{value:"-2",label:i(E.zx.Tsx,{class:[ye,ke],attrs:{type:"success",disabled:!u},on:{click:this.handleCollectAllPrizes}},[c("lobby.modal.task.collectAll")]),isButton:!0},{value:"-1",label:i(E.zx.Tsx,{class:ye,attrs:{type:"primary"},on:{click:this.goRecords}},[c("lobby.promote.pickUpRecord")]),isButton:!0}],p=null!==(t=null===(r=this.taskCategoriesStore.categories)||void 0===r?void 0:r.map((function(e,t){return{itemClass:"tab-".concat(e.taskId),key:"tab-".concat(e.taskId,"-").concat(t),value:e.taskId,label:e.taskName||e.category,badgeCount:e.unReceiveCount}})))&&void 0!==t?t:[];return p=[].concat((0,w.Z)(p),d),i("div",{class:(n={},(0,z.Z)(n,fe,!0),(0,z.Z)(n,me,o),(0,z.Z)(n,"noActivity",o),n)},[i(H.CO,{attrs:{id:"my-task-modal-tabs",badgeClass:Ze,renderList:p,needCacheComponentsList:["tasks"],preTriggerHook:function(e){return a.onTabsChange(e.value)},tabsWidth:this.isWeb?130:150,isScrollY:!0,persistedActiveName:""},scopedSlots:{default:function(){return i("div",{class:be},[a.renderTask(a.taskCategoriesStore.tab)])}},model:{value:a.taskCategoriesStore.tab,callback:function(e){a.$set(a.taskCategoriesStore,"tab",e)}}})])}}]),a}((0,L.Wr)(J.Z)),o=(0,N.Z)(c.prototype,"fetchData",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,N.Z)(c.prototype,"handleCollectAllPrizes",[D.WY,i],Object.getOwnPropertyDescriptor(c.prototype,"handleCollectAllPrizes"),c.prototype),s=c))||s),Te=r(22705),Ce="HDNTMz0u4Aa0Wp8u_Hpi",we="ZGxqmY__AbDoaLYK_EKw",Se="y_YIvoom4t2orJQv0Iq_",Ae="EhcLSvG0NYi0f7CHWvnB",Re="CAVS57DMPt_zHgplmpTi",Pe="spB3w7pAyC4PITf_nyGE",Ie="p7Gegzxy1YbtFVaIZ4Zw",Me="B5m6iFm58m9ersyMnaBm",We="hMkoW4hcuwtrWwyJGDHk",_e=r(8604),ze=function(e){switch(e.status){case O.H3.CanReceive:return e.icon1;case O.H3.HasReceive:return e.icon2;default:return _e}},Ne=(l=(0,L.wA)({name:"TaskModalActivityBox"}),u=(0,L.fI)({required:!0}),d=(0,L.fI)({required:!0}),p=(0,L.fI)(),v=(0,L.fI)({required:!0}),l((f=function(e){(0,W.Z)(a,e);var t,r,n=(0,_.Z)(a);function a(){var e;(0,P.Z)(this,a);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e=n.call.apply(n,[this].concat(r)),(0,X.Z)((0,M.Z)(e),"refresh",y,(0,M.Z)(e)),(0,X.Z)((0,M.Z)(e),"item",k,(0,M.Z)(e)),(0,X.Z)((0,M.Z)(e),"isLast",b,(0,M.Z)(e)),(0,X.Z)((0,M.Z)(e),"parentNode",m,(0,M.Z)(e)),(0,z.Z)((0,M.Z)(e),"state",{pending:!1}),e}return(0,I.Z)(a,[{key:"activityStore",get:function(){return(0,G.j)()}},{key:"mounted",value:function(){this.polling()}},{key:"polling",value:(r=(0,R.Z)((0,A.Z)().mark((function e(){var t=this;return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.sG.Polling.create({key:Y.sG.Polling.LobbyPollingType.ACTIVITY_TIME,callback:function(){return t.activityStore.decreaseResetTime()},leading:!0,interval:1e3});case 2:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"handleCollect",value:(t=(0,R.Z)((0,A.Z)().mark((function e(){var t,r,n,a,i,s=this;return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.item.status===O.H3.CanReceive&&!this.state.pending){e.next=2;break}return e.abrupt("return");case 2:return this.setState({pending:!0}),e.next=5,(0,ge.Z)((0,j.cB)(this.item.id));case 5:if(t=e.sent,r=(0,Te.Z)(t,1),!(n=r[0])){e.next=11;break}return console.error("handleCollect error:",n),e.abrupt("return");case 11:a=(0,V.QT)(),i=a.t,Y.sG.Modal.message({type:"success",content:i("lobby.modal.task.receiveSussessTip")}),this.setState({pending:!1}),this.$nextTick((function(){(0,B.h)().updatePrize(),s.refresh()}));case 15:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e,t,r=arguments[0],n=(0,V.QT)(),a=n.t,i=(0,B.h)(),s=i.isWeb,c=this.item,o=c.awardMinGold,l=c.awardMaxGold,u=c.status,d=c.audit,p=c.gold,v=u===O.H3.HasReceive,h=o===l,f=h?"<span>".concat(o,"</span>"):"<span>".concat(o,"</span>-<span>").concat(l,"</span>"),y=this.item.status===O.H3.CanReceive,k=v?a("lobby.modal.task.activityBoxReceiveTip",{x:d,reward:"<span>".concat(p,"</span>")}):a("lobby.modal.task.activityBoxTip",{x:d,reward:f});return r("li",{class:Ce},[r(E.J2.Tsx,{attrs:{overlayClassName:"".concat(Ie," ").concat(this.isLast?We:""),trigger:s?"hover":"click"}},[r("template",{slot:"content"},[r("div",{class:(0,z.Z)({},Me,!0),domProps:{innerHTML:k}})]),r("div",{class:(e={},(0,z.Z)(e,we,!0),(0,z.Z)(e,Se,y),e),on:{click:this.handleCollect}},[r("my-img",{attrs:{src:ze(this.item),alt:"",width:54,height:45}}),y&&r("span",{class:Ae})])]),r("div",{class:(t={},(0,z.Z)(t,Re,!0),(0,z.Z)(t,Pe,u===O.H3.NotReceive),t)},[this.item.activity])])}}]),a}(L.XY),y=(0,N.Z)(f.prototype,"refresh",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=(0,N.Z)(f.prototype,"item",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=(0,N.Z)(f.prototype,"isLast",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=(0,N.Z)(f.prototype,"parentNode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=f))||h),De=r(18400),Ee=r.n(De),He=(Z=(0,L.wA)({name:"TaskModalComponent"}),g=(0,D.K4)(),Z((T=function(e){(0,W.Z)(i,e);var t,r,n,a=(0,_.Z)(i);function i(){var e;(0,P.Z)(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e=a.call.apply(a,[this].concat(r)),(0,z.Z)((0,M.Z)(e),"renderKey",0),e}return(0,I.Z)(i,[{key:"activityStore",get:function(){return(0,G.j)()}},{key:"taskCategoriesStore",get:function(){return(0,K.$)()}},{key:"isWeb",get:function(){return(0,B.h)().isWeb}},{key:"created",value:function(){this.init()}},{key:"init",value:(n=(0,R.Z)((0,A.Z)().mark((function e(){return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchData();case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"fetchData",value:(r=(0,R.Z)((0,A.Z)().mark((function e(t){var r=this;return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.taskCategoriesStore.fetchCategorys(),this.activityStore.fetchActivity()]).finally((function(){r.activityStore.setIsFetching(!1)}));case 2:t&&(this.renderKey+=1);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"renderHeader",value:function(){var e=this.$createElement,t=(0,V.QT)().t;return e("div",{class:re},[e("div",{class:ne},[t("lobby.modal.task.title")])])}},{key:"getProgressConfig",value:function(){var e,t,r,n=this.activityStore,a=n.box,i=n.rate,s=a.length,c=function(){if(s){var e=a.findIndex((function(e){return e.status===O.H3.NotReceive}));return-1===e?s:e}return 0}(),o=0===s?1:s,l=i,u=null!==(e=null===(t=a[c])||void 0===t?void 0:t.activity)&&void 0!==e?e:0,d=a[c-1]?a[c-1].activity:0;return{currentProgress:c,totalProgress:o,currentWidth:(r=0===u?0:(l-d)/(u-d),r>1.05?1.05:r>0?r<.03?.03:r:0)}}},{key:"renderActivity",value:function(){var e=this,t=this.$createElement,r=(0,V.QT)().t,n=this.activityStore,a=n.activityResetTime;if(n.status===O.Tx.Close)return t("span");var i=function(e){return e<10?"0".concat(e):e},s={d:a.d,h:a.h,m:i(a.m),s:i(a.s)},c=this.getProgressConfig(),o=c.currentProgress,l=c.totalProgress,u=c.currentWidth;return t("div",{class:ie,ref:"activity"},[t("div",{class:se},[t("div",{class:ce,style:{width:"".concat(o/l*100,"%")}})]),t("div",{class:[oe,"left".concat(o)]},[t("div",{class:ce,style:{width:"".concat(100*u,"%")}})]),t("ul",{class:le},[t("li",{class:ue}),this.activityStore.box.map((function(r,n){return t(Ne,{attrs:{item:r,isLast:n===e.activityStore.box.length-1,refresh:(0,R.Z)((0,A.Z)().mark((function t(){return(0,A.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.fetchData();case 2:case"end":return t.stop()}}),t)}))),parentNode:e.$refs.activity}})}))]),t("div",{class:de},[t("div",{class:pe},[t("span",[r("lobby.modal.task.activityRate")])]),t("div",{class:ae},[t("icon-sprite",{attrs:{sprite:Ee()}}),t("auto-text",{attrs:{maxSize:this.isWeb?30:26,width:this.isWeb?210:118,mode:"inline",text:this.activityStore.rate.toString()}})])]),t("div",{class:ve},[t("div",{class:he},[r("lobby.modal.task.reactiveTime"),t("span",[a.d?r("lobby.modal.task.reactiveTime2",s):r("lobby.modal.task.reactiveTime1",s)])])])])}},{key:"renderTask",value:function(e){var t=this.$createElement,r=this.taskCategoriesStore.categories.find((function(t){return t.taskId===e}));return r?t(ee.Z,{attrs:{tab:this.taskCategoriesStore.tab,category:r},key:r.category+this.renderKey}):t("template")}},{key:"goRecords",value:function(){Y.sG.Modal.close("taskModal"),this.$router.push({name:Q.x4.RECORDS})}},{key:"handleCollectAllPrizes",value:(t=(0,R.Z)((0,A.Z)().mark((function e(){var t,r,n,a,i,s,c=this;return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,V.QT)(),r=t.t,n=this.activityStore,a=n.setIsFetching,i=n.box,s=this.taskCategoriesStore.categories,this.openReceiveModal({type:J.A.TASK,content:r("lobby.receiveModal.eventContent"),onOk:function(){var e=(0,R.Z)((0,A.Z)().mark((function e(){var t,n,o,l,u,d,p,v;return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a(!0),t=null==i?void 0:i.filter((function(e){return e.status===O.H3.CanReceive})),null==t||!t.length){e.next=21;break}n=(0,S.Z)(t),e.prev=5,n.s();case 7:if((o=n.n()).done){e.next=13;break}return l=o.value,e.next=11,(0,ge.Z)((0,j.cB)(l.id));case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:return u=s.reduce((function(e,t){var r;return null!==(r=t.receiveRuleIds)&&void 0!==r&&r.length?e.concat(t.receiveRuleIds.map((function(e){return{taskid:t.taskId,template:t.template,ruleid:e}}))):e}),[]),d=[],p=[],u.map((function(e){var t=e.taskid+"_"+e.template;-1===d.indexOf(t)&&d.push(t)})),d.map((function(e){p.push({taskid:Number(e.split("_")[0]),template:Number(e.split("_")[1]),disabled:!1})})),e.next=28,Promise.all(p.map(function(){var e=(0,R.Z)((0,A.Z)().mark((function e(t){return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.uA)({taskid:t.taskid,template:t.template}).then((function(e){(0,$.cA)(e.receiveDeviceType)||(t.disabled=!0)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 28:if(p.map((function(e){e.disabled&&u.map((function(t){t.taskid===e.taskid&&t.template===e.template&&(t.disabled=!0)}))})),u=u.filter((function(e){return!0!==e.disabled})),!u.length){e.next=35;break}return e.next=33,Promise.all(u.map(function(){var e=(0,R.Z)((0,A.Z)().mark((function e(t){return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ge.Z)((0,j.Kp)({taskid:t.taskid,template:t.template,ruleid:t.ruleid}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 33:e.sent.every((function(e){return!e[0]}))&&(Y.sG.Modal.message({type:"success",content:r("lobby.modal.task.receiveSussessTip")}),(0,B.h)().updateReceiveAward());case 35:return e.next=37,c.fetchData(!!u.length);case 37:(v=(0,B.h)()).audioReceivePlay(),v.updatePrize(),e.next=45;break;case 42:e.prev=42,e.t1=e.catch(0),console.error(e.t1);case 45:case"end":return e.stop()}}),e,null,[[0,42],[5,15,18,21]])})));return function(){return e.apply(this,arguments)}}()});case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"renderTabView",value:function(){var e,t,r=this,n=this.$createElement,a=(0,V.QT)().t,i=this.activityStore.status===O.Tx.Close,s=this.taskCategoriesStore.categories.some((function(e){var t;return null===(t=e.receiveRuleIds)||void 0===t?void 0:t.length}))||(null===(e=this.activityStore.box)||void 0===e?void 0:e.some((function(e){return e.status===O.H3.CanReceive}))),c=[{value:"-2",label:n(E.zx.Tsx,{class:[ye,ke],attrs:{type:"success",disabled:!s},on:{click:this.handleCollectAllPrizes}},[a("lobby.modal.task.collectAll")]),isButton:!0},{value:"-1",label:n(E.zx.Tsx,{class:ye,attrs:{type:"primary"},on:{click:this.goRecords}},[a("lobby.promote.pickUpRecord")]),isButton:!0}];return n("div",{class:(t={},(0,z.Z)(t,fe,!0),(0,z.Z)(t,me,i),(0,z.Z)(t,"noActivity",i),t)},[n(H.CO,{attrs:{id:"my-task-modal-tabs",badgeClass:Ze,renderList:[].concat((0,w.Z)(this.taskCategoriesStore.categories.map((function(e){return{itemClass:"tab-".concat(e.taskId),value:e.taskId,label:e.taskName||e.category,badgeCount:e.unReceiveCount}}))),c),tabsWidth:this.isWeb?130:150,isScrollY:!0,persistedActiveName:""},on:{trigger:function(e){return r.taskCategoriesStore.setTab(Number(e))}},scopedSlots:{default:function(){return n("div",{class:be},[r.renderTask(r.taskCategoriesStore.tab)])}},model:{value:r.taskCategoriesStore.tab,callback:function(e){r.$set(r.taskCategoriesStore,"tab",e)}}})])}},{key:"render",value:function(){var e=arguments[0];return e(H.gE,{attrs:{spinning:this.activityStore.isFetching}},[this.renderHeader(),this.renderActivity(),e(xe,{attrs:{fetchData:this.fetchData}})])}},{key:"beforeDestroy",value:function(){this.taskCategoriesStore.setTab(1),Y.sG.Polling.destroy(Y.sG.Polling.LobbyPollingType.ACTIVITY_TIME),this.activityStore.setIsFetching(!1),this.activityStore.setVisibility(!1)}}]),i}((0,L.Wr)(J.Z)),(0,N.Z)(T.prototype,"handleCollectAllPrizes",[D.WY,g],Object.getOwnPropertyDescriptor(T.prototype,"handleCollectAllPrizes"),T.prototype),x=T))||x),Le=(0,L.wA)({name:"TaskModal"})(C=function(e){(0,W.Z)(n,e);var t,r=(0,_.Z)(n);function n(){return(0,P.Z)(this,n),r.apply(this,arguments)}return(0,I.Z)(n,[{key:"activityStore",get:function(){return(0,G.j)()}},{key:"isWeb",get:function(){return(0,B.h)().isWeb}},{key:"open",value:(t=(0,R.Z)((0,A.Z)().mark((function e(){return(0,A.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.baseOpen();case 2:this.activityStore.setVisibility(!0);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=arguments[0];if(!this.activityStore.visibility)return e("template");var t=this.isWeb?1e3:710;return this.renderModal({modalConfig:{class:[te],props:{width:F.ZP.px2rem(t),destroyOnClose:!0}},renderContent:function(){return e(He)}})}}]),n}(q.Z))||C}}]);